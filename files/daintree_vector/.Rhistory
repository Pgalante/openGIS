#Climate Change Variability
CCvar.mod<-lme(fixed = scale (PE) ~ scale(Precip_variability) + scale(Temp_variability), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(CCvar.mod) # AIC: 395.4062
r.squared.lme(CCvar.mod) # C: 0.1340909
#
CCvar.mod.cc<-lme(fixed = scale (PE) ~ scale(Precip_variability) + scale(Temp_variability)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(CCvar.mod.cc) # AIC: 395.4062
r.squared.lme(CCvar.mod.cc) # C: 0.1340909
#
pCCvar<-anova(CCvar.mod, PE_null_geoCC)
pCCvar.cc<-anova(CCvar.mod.cc, PE_null_geodum)
#
CCvar.mod$coefficients$fixed
CCvar.mod.cc$coefficients$fixed
#######################################################
#Climate Change Velocity
CCvel.mod<-lme(fixed = scale (PE) ~ scale(CCvel), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(CCvel.mod) # 399.6294
r.squared.lme(CCvel.mod) #C: 0.06988413
#
CCvel.mod.cc<-lme(fixed = scale (PE) ~ scale(CCvel)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(CCvel.mod.cc) # 399.6294
r.squared.lme(CCvel.mod.cc) #C: 0.06988413
#
pCCvel<-anova(CCvel.mod, PE_null_geoCC)
pCCvel.cc<-anova(CCvel.mod.cc, PE_null_geodum)
#
CCvel.mod$coefficients$fixed
CCvel.mod.cc$coefficients$fixed
##########################################################
#Isolation by elevation
Iso.elev.mod<-lme(fixed = scale (PE) ~ scale(Iso_elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(Iso.elev.mod) # 396.1357
r.squared.lme(Iso.elev.mod) #C: 0.09390373
#
Iso.elev.mod.cc<-lme(fixed = scale (PE) ~ scale(Iso_elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(Iso.elev.mod.cc) # 396.1357
r.squared.lme(Iso.elev.mod.cc) #C: 0.09390373
#
pIso.elev<-anova(Iso.elev.mod, PE_null_geoCC)
pIso.elev.cc<-anova(Iso.elev.mod.cc, PE_null_geodum)
#
Iso.elev.mod$coefficients$fixed
Iso.elev.mod.cc$coefficients$fixed
###########################################################
#EA + stability
EA.stab.mod<-lme(fixed = scale (PE) ~ scale(NPP) + scale(temp) + scale(AET) + scale(Bio1_stability) + scale(Bio12_stability), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(EA.stab.mod) # 360.6942
r.squared.lme(EA.stab.mod) #C: 0.4201026
#
EA.stab.mod.cc<-lme(fixed = scale (PE) ~ scale(NPP) + scale(temp) + scale(AET) + scale(Bio1_stability) + scale(Bio12_stability)+ as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(EA.stab.mod.cc) # 360.6942
r.squared.lme(EA.stab.mod.cc) #C: 0.4201026
#
pEA.stab<-anova(EA.stab.mod, PE_null_geoCC)
pEA.stab.cc<-anova(EA.stab.mod.cc, PE_null_geodum)
#
EA.stab.mod$coefficients$fixed
EA.stab.mod.cc$coefficients$fixed
#################################################################
#EA + isolation by elevation
EA.Iso_elev.mod<-lme(fixed = scale (PE) ~ scale(NPP) + scale(temp) + scale(AET) + scale(Iso_elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(EA.Iso_elev.mod) # 365.491
r.squared.lme(EA.Iso_elev.mod) #C: 0.3271728
#
EA.Iso_elev.mod.cc<-lme(fixed = scale (PE) ~ scale(NPP) + scale(temp) + scale(AET) + scale(Iso_elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(EA.Iso_elev.mod.cc) # 365.491
r.squared.lme(EA.Iso_elev.mod.cc) #C: 0.3271728
#
pEA.IsoElev<-anova(EA.Iso_elev.mod, PE_null_geoCC)
pEA.IsoElev.cc<-anova(EA.Iso_elev.mod.cc, PE_null_geodum)
#
EA.Iso_elev.mod$coefficients$fixed
EA.Iso_elev.mod.cc$coefficients$fixed
##################################################################
#EA + isolation by elevation + climate stability
EA.Iso.stab.mod<-lme(fixed = scale (PE) ~ scale(NPP) + scale(temp) + scale(AET) + scale(Iso_elevation) + scale(Bio1_stability) + scale(Bio12_stability), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(EA.Iso.stab.mod) # 357.0979
r.squared.lme(EA.Iso.stab.mod) #C: 0.4243402
#
EA.Iso.stab.mod.cc<-lme(fixed = scale (PE) ~ scale(NPP) + scale(temp) + scale(AET) + scale(Iso_elevation) + scale(Bio1_stability) + scale(Bio12_stability)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(EA.Iso.stab.mod.cc) # 357.0979
r.squared.lme(EA.Iso.stab.mod.cc) #C: 0.4243402
#
pEA.Iso.stab<-anova(EA.Iso.stab.mod, PE_null_geoCC)
pEA.Iso.stab.cc<-anova(EA.Iso.stab.mod.cc, PE_null_geodum)
#
EA.Iso.stab.mod$coefficients$fixed
EA.Iso.stab.mod.cc$coefficients$fixed
##################################################################
#NPP + Isolation by elevation
NPP.iso.mod<-lme(fixed = scale (PE) ~ scale(NPP) + scale(Iso_elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(NPP.iso.mod) # 367.0555
r.squared.lme(NPP.iso.mod) #C: 0.3352871
#
NPP.iso.mod.cc<-lme(fixed = scale (PE) ~ scale(NPP) + scale(Iso_elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(NPP.iso.mod.cc) # 367.0555
r.squared.lme(NPP.iso.mod.cc) #C: 0.3352871
#
pNPP.iso<-anova(NPP.iso.mod, PE_null_geoCC)
pNPP.iso.cc<-anova(NPP.iso.mod.cc, PE_null_geodum)
#
NPP.iso.mod$coefficients$fixed
NPP.iso.mod.cc$coefficients$fixed
#############################################################
#Post LGM stability
P_LGM.stab.mod<-lme(fixed = scale (PE) ~ scale(post_LGM_stab), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(P_LGM.stab.mod) # AIC: 391.428
r.squared.lme(P_LGM.stab.mod) # C: 0.09359296
#
P_LGM.stab.mod.cc<-lme(fixed = scale (PE) ~ scale(post_LGM_stab)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(P_LGM.stab.mod.cc) # AIC: 391.428
r.squared.lme(P_LGM.stab.mod.cc) # C: 0.09359296
#
pP_LGM_stab<-anova(P_LGM.stab.mod, PE_null_geoCC)
pP_LGM_stab.cc<-anova(P_LGM.stab.mod.cc, PE_null_geodum)
#
P_LGM.stab.mod$coefficients$fixed
P_LGM.stab.mod.cc$coefficients$fixed
#############################################################
#EA + Post LGM stability
EA.P_LGM.stab.mod<-lme(fixed = scale (PE) ~ scale(AET) + scale(temp) + scale(NPP) + scale(post_LGM_stab), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(EA.P_LGM.stab.mod) # 370.1491
r.squared.lme(EA.P_LGM.stab.mod) # C: 0.3205919
#
EA.P_LGM.stab.mod.cc<-lme(fixed = scale (PE) ~ scale(AET) + scale(temp) + scale(NPP) + scale(post_LGM_stab)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(EA.P_LGM.stab.mod.cc) # 370.1491
r.squared.lme(EA.P_LGM.stab.mod.cc) # C: 0.3205919
#
pEA.PLGMstab<-anova(EA.P_LGM.stab.mod, PE_null_geoCC)
pEA.PLGMstab.cc<-anova(EA.P_LGM.stab.mod.cc, PE_null_geodum)
#
EA.P_LGM.stab.mod$coefficients$fixed
EA.P_LGM.stab.mod.cc$coefficients$fixed
##############################################################
#EA + Post LGM stability + Isolation by elevation
EA.P_LGM.Iso.stab.mod<-lme(fixed = scale (PE) ~ scale(AET) + scale(temp) + scale(NPP) + scale(post_LGM_stab) + scale(Iso_elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(EA.P_LGM.Iso.stab.mod) # 367.2172
r.squared.lme(EA.P_LGM.Iso.stab.mod) # C: 0.3270732
#
EA.P_LGM.Iso.stab.mod.cc<-lme(fixed = scale (PE) ~ scale(AET) + scale(temp) + scale(NPP) + scale(post_LGM_stab) + scale(Iso_elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(EA.P_LGM.Iso.stab.mod.cc) # 367.2172
r.squared.lme(EA.P_LGM.Iso.stab.mod.cc) # C: 0.3270732
#
pEA.PLGMiso.stab<-anova(EA.P_LGM.Iso.stab.mod, PE_null_geoCC)
pEA.PLGMiso.stab.cc<-anova(EA.P_LGM.Iso.stab.mod.cc, PE_null_geodum)
#
EA.P_LGM.Iso.stab.mod$coefficients$fixed
EA.P_LGM.Iso.stab.mod.cc$coefficients$fixed
###############################################################
#elevation
elevation.mod<-lme(fixed = scale (PE) ~ scale(elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(elevation.mod) # 399.5678
r.squared.lme(elevation.mod) # C: 0.06137771
#
elevation.mod.cc<-lme(fixed = scale (PE) ~ scale(elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(elevation.mod.cc) # 399.5678
r.squared.lme(elevation.mod.cc) # C: 0.06137771
#
pElevation<-anova(elevation.mod, PE_null_geoCC)
pElevation.cc<-anova(elevation.mod.cc, PE_null_geodum)
#
elevation.mod$coefficients$fixed
elevation.mod.cc$coefficients$fixed
################################################################
# EA + elevation
EA.elevation.mod<-lme(fixed = scale (PE) ~ scale(AET) + scale(temp) + scale(NPP) + scale(elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(EA.elevation.mod) # 400.914
r.squared.lme(EA.elevation.mod) # C: 0.7980547
#
EA.elevation.mod.cc<-lme(fixed = scale (PE) ~ scale(AET) + scale(temp) + scale(NPP) + scale(elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(EA.elevation.mod.cc) # 400.914
r.squared.lme(EA.elevation.mod.cc) # C: 0.7980547
#
pEA.elev<-anova(EA.elevation.mod, PE_null_geoCC)
pEA.elev.cc<-anova(EA.elevation.mod.cc, PE_null_geodum)
#
EA.elevation.mod$coefficients$fixed
EA.elevation.mod.cc$coefficients$fixed
################################################################
#NPP + elevation
NPP.elevation.mod<-lme(fixed = scale (PE) ~ scale(NPP) + scale(elevation), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|as.factor(climate_cluster), method='ML')
AIC(NPP.elevation.mod) # AIC: 372.4462
r.squared.lme(NPP.elevation.mod) # C: 0.326307
#
NPP.elevation.mod.cc<-lme(fixed = scale (PE) ~ scale(NPP) + scale(elevation)+as.factor(climate_cluster), data= dat, correlation=corRatio(0.1, form=~x+y), random=~1|dummy, method='ML')
AIC(NPP.elevation.mod.cc) # AIC: 372.4462
r.squared.lme(NPP.elevation.mod.cc) # C: 0.326307
#
pNPP.elev<-anova(NPP.elevation.mod, PE_null_geoCC)
pNPP.elev.cc<-anova(NPP.elevation.mod.cc, PE_null_geodum)
#
NPP.elevation.mod$coefficients$fixed
NPP.elevation.mod.cc$coefficients$fixed
###################################################################################
###############create and write table #############################################
labels<-c("NPP", "NPP.Climate_cluster","EA", "EA.Climate_cluster","AP", "AP.Climate_cluster","temp", "temp.Climate_cluster","AET", "AET.Climate_cluster","Bio1_stability", "Bio1_stability.Climate_cluster",
"Bio12_stability", "Bio12_stability.Climate_cluster", "Climate_stability", "Climate_stability.Climate_cluster","LGM_climate", "LGM_climate.Climate_cluster","LGM_AP", "LGM_AP.Climate_cluster",
"LGM_MAT", "LGM_MAT.Climate_cluster","Temperature_variability", "Temperature_variability.Climate_cluster","Precipitation_variability", "Precipitation_variability.Climate_cluster",
"Climate Change Variablity", "Climate Change Variablity.Climate_cluster","Climate Change Velocity", "Climate Change Velocity.Climate_cluster","IsoElev", "IsoElev.Climate_cluster",
"EA+ClimateStability", "EA+ClimateStability.Climate_cluster","EA+IsoElev", "EA+IsoElev.Climate_cluster","EA+IsoElev+ClimateStab", "EA+IsoElev+ClimateStab.climate_cluster",
"NPP+IsoElev", "NPP+IsoElev.Climate_cluster","pLGMstability", "pLGMstability.Climate_cluster","EA+pLGMstability", "EA+pLGMstabiltiy.Climate_cluster",
"EA+pLGMstability+IsoElev", "EA+pLGMstability+IsoElev.Climate_cluster","elevation", "elevation.Climate_cluster","EA+elevation", "EA+elevation.Climate_cluster",
"NPP+elevation", "NPP+elevation.Climate_cluster")
Coeffs<-c(NPP.mod$coefficients$fixed, NPP.mod.cc$coefficients$fixed, EA.mod$coefficients$fixed, EA.mod.cc$coefficients$fixed, AP.mod$coefficients$fixed, AP.mod.cc$coefficients$fixed,
temp.mod$coefficients$fixed, temp.mod.cc$coefficients$fixed, AET.mod$coefficients$fixed, AET.mod.cc$coefficients$fixed, Bio1stab.mod$coefficients$fixed, Bio1stab.mod.cc$coefficients$fixed,
Bio12stab.mod$coefficients$fixed, Bio12stab.mod.cc$coefficients$fixed, Climstab.mod$coefficients$fixed, Climstab.mod.cc$coefficients$fixed, LGM.climate.mod$coefficients$fixed,
LGM.climate.mod.cc$coefficients$fixed, LGM_AP.mod$coefficients$fixed, LGM_AP.mod.cc$coefficients$fixed, LGM_MAT.mod$coefficients$fixed, LGM_MAT.mod.cc$coefficients$fixed,
Tvar.mod$coefficients$fixed, Tvar.mod.cc$coefficients$fixed, Pvar.mod$coefficients$fixed, Pvar.mod.cc$coefficients$fixed, CCvar.mod$coefficients$fixed, CCvar.mod.cc$coefficients$fixed,
CCvel.mod$coefficients$fixed, CCvel.mod.cc$coefficients$fixed, Iso.elev.mod$coefficients$fixed, Iso.elev.mod.cc$coefficients$fixed, EA.stab.mod$coefficients$fixed, EA.stab.mod.cc$coefficients$fixed,
EA.Iso_elev.mod$coefficients$fixed, EA.Iso_elev.mod.cc$coefficients$fixed, EA.Iso.stab.mod$coefficients$fixed, EA.Iso.stab.mod.cc$coefficients$fixed, NPP.iso.mod$coefficients$fixed,
NPP.iso.mod.cc$coefficients$fixed, P_LGM.stab.mod$coefficients$fixed, P_LGM.stab.mod.cc$coefficients$fixed, EA.P_LGM.stab.mod$coefficients$fixed, EA.P_LGM.stab.mod.cc$coefficients$fixed,
EA.P_LGM.Iso.stab.mod$coefficients$fixed, EA.P_LGM.Iso.stab.mod.cc$coefficients$fixed, elevation.mod$coefficients$fixed, elevation.mod.cc$coefficients$fixed, EA.elevation.mod$coefficients$fixed,
EA.elevation.mod.cc$coefficients$fixed, NPP.elevation.mod$coefficients$fixed, NPP.elevation.mod.cc$coefficients$fixed)
AICs<-c(AIC(NPP.mod), AIC(NPP.mod.cc), AIC(EA.mod), AIC(EA.mod.cc), AIC(AP.mod), AIC(AP.mod.cc), AIC(temp.mod), AIC(temp.mod.cc), AIC(AET.mod), AIC(AET.mod.cc), AIC(Bio1stab.mod), AIC(Bio1stab.mod.cc),
AIC(Bio12stab.mod), AIC(Bio12stab.mod.cc), AIC(Climstab.mod), AIC(Climstab.mod.cc), AIC(LGM.climate.mod), AIC(LGM.climate.mod.cc), AIC(LGM_AP.mod),  AIC(LGM_AP.mod.cc),
AIC(LGM_MAT.mod), AIC(LGM_MAT.mod.cc), AIC(Tvar.mod), AIC(Tvar.mod.cc), AIC(Pvar.mod), AIC(Pvar.mod.cc), AIC(CCvar.mod), AIC(CCvar.mod.cc), AIC(CCvel.mod), AIC(CCvel.mod.cc),
AIC(Iso.elev.mod), AIC(Iso.elev.mod.cc), AIC(EA.stab.mod), AIC(EA.stab.mod.cc), AIC(EA.Iso_elev.mod), AIC(EA.Iso_elev.mod.cc), AIC(EA.Iso.stab.mod), AIC(EA.Iso.stab.mod.cc),
AIC(NPP.iso.mod), AIC(NPP.iso.mod.cc), AIC(P_LGM.stab.mod), AIC(P_LGM.stab.mod.cc), AIC(EA.P_LGM.stab.mod), AIC(EA.P_LGM.stab.mod.cc), AIC(EA.P_LGM.Iso.stab.mod), AIC(EA.P_LGM.Iso.stab.mod.cc),
AIC(elevation.mod), AIC(elevation.mod.cc), AIC(EA.elevation.mod), AIC(EA.elevation.mod.cc), AIC(NPP.elevation.mod), AIC(NPP.elevation.mod.cc))
Pvals<-c(pNPP$`p-value`[2], pNPP.cc$`p-value`[2], pEA$`p-value`[2], pEA.cc$`p-value`[2], pAP$`p-value`[2], pAP.cc$`p-value`[2], ptemp$`p-value`[2], ptemp.cc$`p-value`[2], pAET$`p-value`[2],
pAET.cc$`p-value`[2], pBio1stab$`p-value`[2], pBio1stab.cc$`p-value`[2], pBio12stab$`p-value`[2], pBio12stab.cc$`p-value`[2], pClimstab$`p-value`[2], pClimstab.cc$`p-value`[2],
pLGMclimate$`p-value`[2], pLGMclimate.cc$`p-value`[2], pLGM_AP$`p-value`[2], pLGM_AP.cc$`p-value`[2], pLGM_MAT$`p-value`[2], pLGM_MAT.cc$`p-value`[2], pTvar$`p-value`[2],
pTvar.cc$`p-value`[2], pCCvar$`p-value`[2], pCCvar.cc$`p-value`[2], pCCvel$`p-value`[2], pCCvel.cc$`p-value`[2], pIso.elev$`p-value`[2], pIso.elev.cc$`p-value`[2], pEA.stab$`p-value`[2],
pEA.stab.cc$`p-value`[2], pEA.IsoElev$`p-value`[2], pEA.IsoElev.cc$`p-value`[2], pEA.Iso.stab$`p-value`[2], pEA.Iso.stab.cc$`p-value`[2], pNPP.iso$`p-value`[2], pNPP.iso.cc$`p-value`[2],
pP_LGM_stab$`p-value`[2], pP_LGM_stab.cc$`p-value`[2], pEA.PLGMstab$`p-value`[2], pEA.PLGMstab.cc$`p-value`[2], pEA.PLGMiso.stab$`p-value`[2], pEA.PLGMiso.stab.cc$`p-value`[2],
pElevation$`p-value`[2], pElevation.cc$`p-value`[2], pEA.elev$`p-value`[2], pEA.elev.cc$`p-value`[2], pNPP.elev$`p-value`[2], pNPP.elev.cc$`p-value`[2])
R2s<-c(r.squared.lme(NPP.mod)$Conditional, r.squared.lme(NPP.mod.cc)$Conditional, r.squared.lme(EA.mod)$Conditional, r.squared.lme(EA.mod.cc)$Conditional,
r.squared.lme(AP.mod)$Conditional, r.squared.lme(AP.mod.cc)$Conditional, r.squared.lme(temp.mod)$Conditional, r.squared.lme(temp.mod.cc)$Conditional,
r.squared.lme(AET.mod)$Conditional, r.squared.lme(AET.mod.cc)$Conditional, r.squared.lme(Bio1stab.mod)$Conditional, r.squared.lme(Bio1stab.mod.cc)$Conditional,
r.squared.lme(Bio12stab.mod)$Conditional, r.squared.lme(Bio12stab.mod.cc)$Conditional, r.squared.lme(Climstab.mod)$Conditional, r.squared.lme(Climstab.mod.cc)$Conditional,
r.squared.lme(LGM.climate.mod)$Conditional, r.squared.lme(LGM.climate.mod.cc)$Conditional, r.squared.lme(LGM_AP.mod)$Conditional, r.squared.lme(LGM_AP.mod.cc)$Conditional,
r.squared.lme(LGM_MAT.mod)$Conditional, r.squared.lme(LGM_MAT.mod.cc)$Conditional, r.squared.lme(Tvar.mod)$Conditional, r.squared.lme(Tvar.mod.cc)$Conditional,
r.squared.lme(Pvar.mod)$Conditional, r.squared.lme(Pvar.mod.cc)$Conditional, r.squared.lme(CCvar.mod)$Conditional, r.squared.lme(CCvar.mod.cc)$Conditional,
r.squared.lme(CCvel.mod)$Conditional, r.squared.lme(CCvel.mod.cc)$Conditional, r.squared.lme(Iso.elev.mod)$Conditional, r.squared.lme(Iso.elev.mod.cc)$Conditional,
r.squared.lme(EA.stab.mod)$Conditional, r.squared.lme(EA.stab.mod.cc)$Conditional, r.squared.lme(EA.Iso_elev.mod)$Conditional, r.squared.lme(EA.Iso_elev.mod.cc)$Conditional,
r.squared.lme(EA.Iso.stab.mod)$Conditional, r.squared.lme(EA.Iso.stab.mod.cc)$Conditional, r.squared.lme(NPP.iso.mod)$Conditional, r.squared.lme(NPP.iso.mod.cc)$Conditional,
r.squared.lme(P_LGM.stab.mod)$Conditional, r.squared.lme(P_LGM.stab.mod.cc)$Conditional, r.squared.lme(EA.P_LGM.stab.mod)$Conditional, r.squared.lme(EA.P_LGM.stab.mod.cc)$Conditional,
r.squared.lme(EA.P_LGM.Iso.stab.mod)$Conditional, r.squared.lme(EA.P_LGM.Iso.stab.mod.cc)$Conditional, r.squared.lme(elevation.mod)$Conditional, r.squared.lme(elevation.mod.cc)$Conditional,
r.squared.lme(EA.elevation.mod)$Conditional, r.squared.lme(EA.elevation.mod.cc)$Conditional, r.squared.lme(NPP.elevation.mod)$Conditional, r.squared.lme(NPP.elevation.mod.cc)$Conditional)
Pvals
R2s
AICs
Coeffs
NPP.mod$coefficients$fixed
NPP.mod$coefficients$fixed
class(NPP.mod$coefficients$fixed)
NPP.mod.cc$coefficients$fixed
both<-rbind(labels, AICs, R2s)
both
t(both)
rbind(NPP.mod$coefficients$fixed,NPP.mod.cc$coefficients$fixed)
Coeffs<-rbind(NPP.mod$coefficients$fixed, NPP.mod.cc$coefficients$fixed, EA.mod$coefficients$fixed, EA.mod.cc$coefficients$fixed, AP.mod$coefficients$fixed, AP.mod.cc$coefficients$fixed,
temp.mod$coefficients$fixed, temp.mod.cc$coefficients$fixed, AET.mod$coefficients$fixed, AET.mod.cc$coefficients$fixed, Bio1stab.mod$coefficients$fixed, Bio1stab.mod.cc$coefficients$fixed,
Bio12stab.mod$coefficients$fixed, Bio12stab.mod.cc$coefficients$fixed, Climstab.mod$coefficients$fixed, Climstab.mod.cc$coefficients$fixed, LGM.climate.mod$coefficients$fixed,
LGM.climate.mod.cc$coefficients$fixed, LGM_AP.mod$coefficients$fixed, LGM_AP.mod.cc$coefficients$fixed, LGM_MAT.mod$coefficients$fixed, LGM_MAT.mod.cc$coefficients$fixed,
Tvar.mod$coefficients$fixed, Tvar.mod.cc$coefficients$fixed, Pvar.mod$coefficients$fixed, Pvar.mod.cc$coefficients$fixed, CCvar.mod$coefficients$fixed, CCvar.mod.cc$coefficients$fixed,
CCvel.mod$coefficients$fixed, CCvel.mod.cc$coefficients$fixed, Iso.elev.mod$coefficients$fixed, Iso.elev.mod.cc$coefficients$fixed, EA.stab.mod$coefficients$fixed, EA.stab.mod.cc$coefficients$fixed,
EA.Iso_elev.mod$coefficients$fixed, EA.Iso_elev.mod.cc$coefficients$fixed, EA.Iso.stab.mod$coefficients$fixed, EA.Iso.stab.mod.cc$coefficients$fixed, NPP.iso.mod$coefficients$fixed,
NPP.iso.mod.cc$coefficients$fixed, P_LGM.stab.mod$coefficients$fixed, P_LGM.stab.mod.cc$coefficients$fixed, EA.P_LGM.stab.mod$coefficients$fixed, EA.P_LGM.stab.mod.cc$coefficients$fixed,
EA.P_LGM.Iso.stab.mod$coefficients$fixed, EA.P_LGM.Iso.stab.mod.cc$coefficients$fixed, elevation.mod$coefficients$fixed, elevation.mod.cc$coefficients$fixed, EA.elevation.mod$coefficients$fixed,
EA.elevation.mod.cc$coefficients$fixed, NPP.elevation.mod$coefficients$fixed, NPP.elevation.mod.cc$coefficients$fixed)
length(NPP.mod.cc$coefficients$fixed)
Coeffs<-merge(NPP.mod$coefficients$fixed, NPP.mod.cc$coefficients$fixed, EA.mod$coefficients$fixed, EA.mod.cc$coefficients$fixed, AP.mod$coefficients$fixed, AP.mod.cc$coefficients$fixed,
temp.mod$coefficients$fixed, temp.mod.cc$coefficients$fixed, AET.mod$coefficients$fixed, AET.mod.cc$coefficients$fixed, Bio1stab.mod$coefficients$fixed, Bio1stab.mod.cc$coefficients$fixed,
Bio12stab.mod$coefficients$fixed, Bio12stab.mod.cc$coefficients$fixed, Climstab.mod$coefficients$fixed, Climstab.mod.cc$coefficients$fixed, LGM.climate.mod$coefficients$fixed,
LGM.climate.mod.cc$coefficients$fixed, LGM_AP.mod$coefficients$fixed, LGM_AP.mod.cc$coefficients$fixed, LGM_MAT.mod$coefficients$fixed, LGM_MAT.mod.cc$coefficients$fixed,
Tvar.mod$coefficients$fixed, Tvar.mod.cc$coefficients$fixed, Pvar.mod$coefficients$fixed, Pvar.mod.cc$coefficients$fixed, CCvar.mod$coefficients$fixed, CCvar.mod.cc$coefficients$fixed,
CCvel.mod$coefficients$fixed, CCvel.mod.cc$coefficients$fixed, Iso.elev.mod$coefficients$fixed, Iso.elev.mod.cc$coefficients$fixed, EA.stab.mod$coefficients$fixed, EA.stab.mod.cc$coefficients$fixed,
EA.Iso_elev.mod$coefficients$fixed, EA.Iso_elev.mod.cc$coefficients$fixed, EA.Iso.stab.mod$coefficients$fixed, EA.Iso.stab.mod.cc$coefficients$fixed, NPP.iso.mod$coefficients$fixed,
NPP.iso.mod.cc$coefficients$fixed, P_LGM.stab.mod$coefficients$fixed, P_LGM.stab.mod.cc$coefficients$fixed, EA.P_LGM.stab.mod$coefficients$fixed, EA.P_LGM.stab.mod.cc$coefficients$fixed,
EA.P_LGM.Iso.stab.mod$coefficients$fixed, EA.P_LGM.Iso.stab.mod.cc$coefficients$fixed, elevation.mod$coefficients$fixed, elevation.mod.cc$coefficients$fixed, EA.elevation.mod$coefficients$fixed,
EA.elevation.mod.cc$coefficients$fixed, NPP.elevation.mod$coefficients$fixed, NPP.elevation.mod.cc$coefficients$fixed)
merge(NPP.mod$coefficients$fixed,NPP.mod.cc$coefficients$fixed)
NPP.mod.cc$coefficients$fixed
NPP.mod$coefficients$fixed
matrix(NPP.mod$coefficients$fixed)
data.frame(NPP.mod$coefficients$fixed)
data.frame(NPP.mod.cc$coefficients$fixed)
ttt<-data.frame(NPP.mod$coefficients$fixed)
rrr<-data.frame(NPP.mod.cc$coefficients$fixed)
rrr
ttt
cbind(ttt,rrr)
rrr
rrr
ttt
cbind(ttt,rrr)
t(cbind(ttt,rrr))
ttt <-matrix(NPP.mod$coefficients$fixed)
ttt
rrr <-matrix(NPP.mod.cc$coefficients$fixed)
rrr
rbind(ttt, rrr)
cbind(ttt, rrr)
ttt <-vector(NPP.mod$coefficients$fixed)
ttt <-as.vector(NPP.mod$coefficients$fixed)
ttt
rrr <-as.vector(NPP.mod.cc$coefficients$fixed)
rrr
rbind(ttt, rrr)
cbind(ttt, rrr)
ttt
rrr
data.frame(ttt, rrr)
ttt
rrr
n<-max(length(ttt),length(rrr))
n
length(ttt)<-n
length(rrr)<-n
ttt
data.frame(ttt, rrr)
library(dismo)
library(rgdal)
library(maps)
continents<-readOGR(dsn = "C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Session1_data", layer = "ne_50m_admin_0_countries")
plot(continents)
N.America<-subset(continents, continent = "North America")
plot(N.America)
N.America
?subset
N.America<-subset(continents, continent = "North America")
continents
continents@data$continent
continents@data$continent=="North America"
N.America<-continents[continents@data$continent=="North America"]
N.America<-continents[,continents@data$continent=="North America"]
N.America<-continents[continents@data$continent=="North America",]
N.America
plot(N.America)
Amb.opa<-crop(N.America, extent(c(-99, -66, 46, 23)))
Amb.opa
plot(Amb.opa, col='blue')
MarbSalam<- gbif(genus = "Ambystoma", species = "opacum", download = T)
Locs<-na.omit(data.matrix(cbind(MarbSalam$species, MarbSalam$lon, MarbSalam$lat)))
Locs
colnames(Locs)<-c("SPECIES","LONG","LAT")
points(Locs[,2:3], col='yellow', pch=16)
extent(Locs)
extent(Locs[,2:3])
Locs[,2:3]
class(Locs[,2:3])
data.frame(Locs[,2:3])
extent(data.frame(Locs[,2:3]))
test<-crop(continents, extent(data.frame(Locs[,2:3])))
extent(data.frame(Locs[,2:3]))
?extent
plot(N.America)
points(Locs[,2:3], col='red', pch=16)
plot(continents)
points(Locs[,2:3], col='red', pch=16)
min(Locs[,2])
max(Locs[,2])
max(Locs[,3])
min(Locs[,3])
Locs<-na.omit(data.matrix(cbind(MarbSalam$species, MarbSalam$lon, MarbSalam$lat)))
class(Locs)
Locs<-na.omit(data.frame(cbind(MarbSalam$species, MarbSalam$lon, MarbSalam$lat)))
Locs
colnames(Locs)<-c("SPECIES","LONG","LAT")
points(Locs[,2:3], col='red', pch=16)
extent(Locs[,2:3])
names(Locs)
colnames(Locs)<-c("SPECIES","x","y")
extent(Locs[,2:3])
Locs[2]
Locs[[2]]
class(Locs[2])
colnames(Locs)<-c("SPECIES","x","y")
Locs<-na.omit(data.matrix(cbind(MarbSalam$species, MarbSalam$lon, MarbSalam$lat)))
colnames(Locs)<-c("SPECIES","x","y")
extent(Locs[,2:3])
class(Locs[,2:3])
Locs[,2:3][3]
class(Locs[,2:3][3])
MarbSalam
as.integer(MarbSalam$species)
Locs<-na.omit(data.matrix(cbind(integer(MarbSalam$species), MarbSalam$lon, MarbSalam$lat)))
as.numeric(MarbSalam$species)
MarbSalam$lon
class(MarbSalam$lon)
min(MarbSalam$lon)
min(MarbSalam$lon, na.rm=T)
Locs<-na.omit(data.frame(cbind(MarbSalam$species), MarbSalam$lon, MarbSalam$lat))
Locs
extent(Locs[,2:3])
Locs[,2:3]
class(Locs[,2:3])
class(Locs[,2])
Locs[,2]
Locs[,2:3]
Locs<-na.omit(data.frame(cbind(MarbSalam$species), MarbSalam$lon, MarbSalam$lat))
Locs
min(Locs[,2:3])
max(Locs[,2:3])
max(Locs[,2])
min(Locs[,2])
extent(Locs[,2:3])
head(Locs[,2:3])
colnames(Locs)<-c("SPECIES","x","y")
extent(Locs[,2:3])
test<-crop(continents, extent(data.frame(Locs[,2:3])))
plot(test)
points(Locs[,2:3], col='red', pch=16)
Locs<-na.omit(data.frame(cbind(MarbSalam$species), MarbSalam$lon, MarbSalam$lat))
colnames(Locs)<-c("SPECIES","x","y")
test<-crop(continents, extent(data.frame(Locs[,2:3])))
plot(test)
points(Locs[,2:3], col='red', pch=16)
Amb.opa<-crop(N.America, extent(c(-99, -66, 46, 23)))
plot(Amb.opa, col='blue')
points(Locs[,2:3], col='red', pch=16)
legend("bottomright", col='yellow', pch=16, legend = 'Ambystoma opacum')
map.scale(x = -98, y = 23, relwidth=0.25, metric=T)
library(GISTools)
north.arrow(xb=-67, yb = 30, len=0.5, lab="N")
data(wrld_simpl)
plot(data(wrld_simpl))
plot(data(wrld_simpl))
data(wrld_simpl)
wrld_simpl
plot((wrld_simpl)
plot(wrld_simpl)
## Query GBIF for data associated with species name
plot(wrld_simpl)
wrld_simpl@data$REGION
wrld_simpl@data$SUBREGION
wrld_simpl@data$UN
continents@data$continent
wrld_simpl@data$FIPS
wrld_simpl@data$ISO2
wrld_simpl@data$ISO3
wrld_simpl@data$NAME
wrld_simpl[wrld_simpl@data$NAME == "United States]"
wrld_simpl[wrld_simpl@data$NAME == "United States"]
test<-wrld_simpl[wrld_simpl@data$NAME == "United States"]
test<-wrld_simpl[wrld_simpl@data$NAME == "United States",]
plot(test)
points(Locs[,2:3], col='red', pch=16)
plot(wrld_simpl)
plot(test)
test
wrld_simpl
test<-wrld_simpl[wrld_simpl@data$NAME == "United States" | wrld_simpl@data$NAME == "Canada",]
plot(test)
points(Locs[,2:3], col='red', pch=16)
testcrop<-crop(test, extent(c(-99, -66, 46, 23)))
testcrop<-crop(wrld_simpl, extent(c(-99, -66, 46, 23)))
wrld_simpl
crs(extent(c(-99, -66, 46, 23)))
plot(wrld_simpl)
plot(continents)
continents<-readOGR(dsn = "C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Session1_data", layer = "ne_50m_admin_0_countries")
plot(continents)
plot(continents)
plot(test)
plot(continents)
Locs<-na.omit(data.frame(cbind(MarbSalam$species), MarbSalam$lon, MarbSalam$lat))
colnames(Locs)<-c("SPECIES","LONGITUDE","LATITUDE")
library(rgdal)
library(raster)
library(maps)
library(sp)
library(rgeos)
setwd('C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector')
coast<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'coast')
daintree_catch<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'daintree_catch')
dcdb_clip<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'dcdb_clip')
rainforest_clip<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'rainforest_clip')
rivers<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'rivers_clip')
roads<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'roads')
town<- readOGR(dsn = 'C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/vector', layer = 'town')
# Load in the raster to use
daintree_catchment_landsat<-raster("C:/Users/pgalante/Documents/Projects/QGIS_tutorial/RGGS_GIS/Fragmentation_Lab/raster/daintree_catchment_landsat.tif")
## First, we want to select all of the rainforest patches between 50 and 100 hectares in area.
rainforest_clip_selection <- rainforest_clip[rainforest_clip@data$Hectares>50 & rainforest_clip@data$Hectares < 100,]
plot(rainforest_clip_selection)
# Next, we want to identify all freehold and leasehold land in the Daintree Catchment.
# To see the available Tenure options check the levels
levels(dcdb_clip@data$TENURE)
FH<-subset(dcdb_clip, TENURE == "FH")
LL<-subset(dcdb_clip, TENURE == "LL")
freehold_leasehold<-rbind(FH, LL)
# Let's plot this and take a look
plot(freehold_leasehold)
rainforest.coords<-SpatialPoints(coordinates(rainforest_clip_selection))
crs(rainforest.coords)<-'+proj=utm +zone=55 +south +ellps=GRS80 +units=m +no_defs'
freehold.patches<-over(rainforest.coords, freehold_leasehold)
rainforest_freelease <- rainforest_clip_selection[!is.na(over(rainforest.coords,as(freehold_leasehold,"SpatialPolygons"))),]
plot(rainforest_freelease)
rainforest_freelease@data$SI<-(rainforest_freelease@data$PERIMETER/(2*sqrt(rainforest_freelease@data$AREA)))
plot(rainforest_freelease)
core_areas<-SpatialPolygonsDataFrame(Sr = gBuffer(rainforest_freelease, width = -50, byid = T ), data = rainforest_freelease@data)
plot(core_areas)
rainforest_cores<-SpatialPolygonsDataFrame(Sr = gBuffer(rainforest_freelease, width = -50, byid = T ), data = rainforest_freelease@data)
plot(rainforest_cores)
rainforest_cores
rainforest_cores@data
rainforest_freelease@data
plot(rainforest_freelease)
plot(rainforest_cores)
rainforest_cores@data
rainforest_freelease@data
?gArea
gArea(rainforest_cores)
areaPoly(rainforest_cores)
sapply(slot(rainforest_cores, "polygons"), slot, "area")
rainforest_cores@data$Core_area<-sapply(slot(rainforest_cores, "polygons"), slot, "area")
rainforest_cores@data
rainforest_cores@data$CA_ratio<-rainforest_cores@data$AREA/rainforest_cores@data$Core_area
rainforest_cores@data
